<div class="dashboard-background">
  <div class="dashboard-container">
    <h1 class="title">ğŸ“Š Omsoft ACE Intelligence</h1>
    <p class="subtitle">AI prodajni nadzor za lead gen kampanje</p>

    <!-- Tab Navigation -->
    <nav class="tabs">
      <button [class.active]="activeTab==='leads'" (click)="activeTab='leads'">ğŸ”¥ Leads</button>
      <button [class.active]="activeTab==='notes'" (click)="activeTab='notes'">ğŸ““ Notes/Stages</button>
      <button [class.active]="activeTab==='flow'" (click)="activeTab='flow'">ğŸ“Š Sales Flow</button>
    </nav>

    <!-- TAB 1: Leads -->
    <section *ngIf="activeTab==='leads'">
      <h2>ğŸ”¥ Najbolj kvalificirani kontakti (v Å¾ivo)</h2>
      <div class="lead-list">
        <div *ngFor="let lead of rankedLeads" class="lead-entry">
          <div class="lead-main">
            <div class="lead-top">
              <div class="lead-name">{{ lead.name }} ({{ lead.industry }})</div>
              <div class="lead-score">ğŸ”¥ {{ lead.score }}</div>
            </div>
            <div class="lead-summary">
              Stage: {{ lead.stage }} <span class="dot">â€¢</span>
              {{ formatAgo(lead.lastSeenSec) }}
            </div>
            <div class="lead-lastmsg">â€{{ lead.lastMessage }}â€</div>
            <div class="tags">
              <span class="tag good" *ngIf="lead.compatibility">âœ… Compatibility</span>
              <span class="tag" [class.good]="lead.interest==='High'">â­ {{ lead.interest }}</span>
              <span class="tag" [class.good]="lead.phone">ğŸ“ Phone</span>
              <span class="tag" [class.good]="lead.email">ğŸ“§ Email</span>
              <span class="tag" [class.good]="lead.adsExp">ğŸ“ˆ Ads Exp</span>
            </div>
          </div>
          <div class="lead-actions">
            <button class="chat-btn" (click)="takeOver(lead)">Prevzemi pogovor</button>
          </div>
        </div>
      </div>

      <!-- KPIs -->
      <section class="kpis" *ngIf="kpis">
        <div>ğŸ‘¥ Leads: {{ kpis.visitors }}</div>
        <div>ğŸ’¬ Pogovori: {{ kpis.interactions }}</div>
        <div>ğŸ“‡ Kontakti: {{ kpis.contacts }}</div>
        <div>â± Avg. odgovor: {{ kpis.avgResponseSec }}s</div>
        <div>ğŸ”” Aktivni: {{ kpis.activeLeads }}</div>
      </section>
    </section>

    <!-- TAB 2: Notes & Stages -->
    <section *ngIf="activeTab==='notes'">
      <h2>ğŸ““ Notes & Stage Tracking</h2>
      <table class="notes-table">
        <thead>
          <tr>
            <th>Lead</th>
            <th>Stage</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let lead of rankedLeads">
            <td>{{ lead.name }}</td>
            <td>{{ lead.stage }}</td>
            <td>{{ lead.notes }}</td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- TAB 3: Sales Flow -->
    <section *ngIf="activeTab==='flow'">
      <h2>ğŸ“Š Sales Flow & Heatmaps</h2>
        <section *ngIf="activeTab==='flow' && funnel">
        <h2>ğŸ“Š Sales Flow & Heatmaps</h2>
      <div class="funnel">
        <div class="funnel-step">Awareness â†’ <span class="bar awareness">{{ funnel.awareness }}%</span></div>
        <div class="funnel-step">Interest â†’ <span class="bar interest">{{ funnel.interest }}%</span></div>
        <div class="funnel-step">Meeting â†’ <span class="bar meeting">{{ funnel.meeting }}%</span></div>
        <div class="funnel-step">Close â†’ <span class="bar close">{{ funnel.close }}%</span></div>
      </div>

  <h3>Objections (Ranked)</h3>
  <ol>
    <li *ngFor="let obj of objections">{{ obj }}</li>
  </ol>
</section>


      <h3>Objections (Ranked)</h3>
      <ol>
        <li *ngFor="let obj of objections">{{ obj }}</li>
      </ol>
    </section>
  </div>
</div>
